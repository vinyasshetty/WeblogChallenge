1) aggregrate all page hits by visitor/IP during a session , descending count
+---------+--------------+-----+--------------------------+--------------------------+
|sessionid|clientip      |cnt  |session_starttime         |session_endtime           |
+---------+--------------+-----+--------------------------+--------------------------+
|7        |119.81.61.166 |10540|2015-07-22 16:10:28.394091|2015-07-22 16:25:05.211263|
|7        |52.74.219.71  |6714 |2015-07-22 16:10:28.056562|2015-07-22 16:25:05.202249|
|4        |52.74.219.71  |6016 |2015-07-22 10:30:28.220275|2015-07-22 10:39:47.42702 |
|11       |106.186.23.95 |5114 |2015-07-22 21:05:28.048908|2015-07-22 21:10:27.952944|
|0        |106.51.132.54 |4399 |2015-07-22 16:10:28.051642|2015-07-22 16:14:52.013537|
|10       |52.74.219.71  |4277 |2015-07-22 18:00:28.444086|2015-07-22 18:05:27.566212|
|9        |119.81.61.166 |4054 |2015-07-22 17:40:28.042128|2015-07-22 17:45:28.037648|
|11       |52.74.219.71  |3831 |2015-07-22 21:05:28.077091|2015-07-22 21:10:27.95016 |
|10       |119.81.61.166 |3763 |2015-07-22 18:00:28.6032  |2015-07-22 18:05:27.768298|
|9        |52.74.219.71  |3575 |2015-07-22 17:40:28.080159|2015-07-22 17:45:27.904253|
|0        |119.81.61.166 |3429 |2015-07-22 02:40:06.77039 |2015-07-22 02:45:03.781765|
|3        |52.74.219.71  |3090 |2015-07-22 09:00:28.348141|2015-07-22 09:04:43.352165|
|11       |119.81.61.166 |2987 |2015-07-22 21:05:28.042763|2015-07-22 21:10:27.654732|
|8        |119.81.61.166 |2891 |2015-07-22 16:40:28.222688|2015-07-22 16:44:48.462751|
|5        |52.74.219.71  |2842 |2015-07-22 10:45:28.320258|2015-07-22 10:49:52.557803|
|8        |52.74.219.71  |2753 |2015-07-22 16:40:28.370059|2015-07-22 16:44:48.434167|
|6        |52.74.219.71  |2751 |2015-07-22 11:00:28.722157|2015-07-22 11:04:57.382184|
|1        |52.74.219.71  |2295 |2015-07-22 05:10:07.342661|2015-07-22 05:15:07.066653|
|2        |54.169.20.106 |1979 |2015-07-22 16:10:29.567476|2015-07-22 16:24:03.20708 |
|1        |112.196.25.164|1946 |2015-07-22 17:40:28.116902|2015-07-22 17:45:27.894465|
+---------+--------------+-----+--------------------------+--------------------------+
only showing top 20 rows

2) Determine the average session time
+-------------------+
|avgsession(in mins)|
+-------------------+
|       1.4907047352|
+-------------------+

3) Determine unique URL visits per session. Hence used countDistinct.Desc order on distinct url count.
+---------+-------------+--------------------------+--------------------------+---------------------+
|sessionid|clientip     |session_starttime         |session_endtime           |distincturlpersession|
+---------+-------------+--------------------------+--------------------------+---------------------+
|7        |119.81.61.166|2015-07-22 16:10:28.394091|2015-07-22 16:25:05.211263|8016                 |
|7        |52.74.219.71 |2015-07-22 16:10:28.056562|2015-07-22 16:25:05.202249|5478                 |
|4        |52.74.219.71 |2015-07-22 10:30:28.220275|2015-07-22 10:39:47.42702 |5057                 |
|11       |106.186.23.95|2015-07-22 21:05:28.048908|2015-07-22 21:10:27.952944|4656                 |
|9        |119.81.61.166|2015-07-22 17:40:28.042128|2015-07-22 17:45:28.037648|3928                 |
|10       |119.81.61.166|2015-07-22 18:00:28.6032  |2015-07-22 18:05:27.768298|3637                 |
|0        |119.81.61.166|2015-07-22 02:40:06.77039 |2015-07-22 02:45:03.781765|3334                 |
|10       |52.74.219.71 |2015-07-22 18:00:28.444086|2015-07-22 18:05:27.566212|2907                 |
|11       |119.81.61.166|2015-07-22 21:05:28.042763|2015-07-22 21:10:27.654732|2841                 |
|8        |119.81.61.166|2015-07-22 16:40:28.222688|2015-07-22 16:44:48.462751|2786                 |
|0        |106.51.132.54|2015-07-22 16:10:28.051642|2015-07-22 16:14:52.013537|2609                 |
|3        |52.74.219.71 |2015-07-22 09:00:28.348141|2015-07-22 09:04:43.352165|2572                 |
|5        |52.74.219.71 |2015-07-22 10:45:28.320258|2015-07-22 10:49:52.557803|2569                 |
|9        |52.74.219.71 |2015-07-22 17:40:28.080159|2015-07-22 17:45:27.904253|2535                 |
|11       |52.74.219.71 |2015-07-22 21:05:28.077091|2015-07-22 21:10:27.95016 |2466                 |
|8        |52.74.219.71 |2015-07-22 16:40:28.370059|2015-07-22 16:44:48.434167|2458                 |
|1        |52.74.219.71 |2015-07-22 05:10:07.342661|2015-07-22 05:15:07.066653|2037                 |
|6        |52.74.219.71 |2015-07-22 11:00:28.722157|2015-07-22 11:04:57.382184|1958                 |
|2        |54.169.20.106|2015-07-22 16:10:29.567476|2015-07-22 16:24:03.20708 |1896                 |
|2        |119.81.61.166|2015-07-22 06:55:07.896678|2015-07-22 07:00:07.059378|1671                 |
+---------+-------------+--------------------------+--------------------------+---------------------+
only showing top 20 rows

4) Find the most engaged users, ie the IPs with the longest session times
+---------+---------------+-----------+--------------------------+--------------------------+
|sessionid|clientip       |sessiontime|session_starttime         |session_endtime           |
+---------+---------------+-----------+--------------------------+--------------------------+
|0        |117.199.107.47 |14.999949  |2015-07-22 10:48:09.498826|2015-07-22 11:03:09.495755|
|4        |125.19.44.66   |14.999932  |2015-07-22 10:30:28.187923|2015-07-22 10:45:28.183869|
|0        |112.133.246.6  |14.999881  |2015-07-22 10:33:55.985465|2015-07-22 10:48:55.978351|
|1        |203.99.211.133 |14.999864  |2015-07-22 10:47:30.202734|2015-07-22 11:02:30.194579|
|0        |1.186.101.79   |14.999862  |2015-07-22 10:45:55.881199|2015-07-22 11:00:55.872936|
|4        |121.242.40.15  |14.999835  |2015-07-22 10:46:16.840687|2015-07-22 11:01:16.830805|
|1        |119.235.50.12  |14.999808  |2015-07-22 10:30:50.063207|2015-07-22 10:45:50.051669|
|1        |59.160.139.117 |14.999804  |2015-07-22 10:30:47.70931 |2015-07-22 10:45:47.697543|
|1        |123.63.47.173  |14.999640  |2015-07-22 10:34:25.749231|2015-07-22 10:49:25.727605|
|2        |122.248.183.22 |14.999540  |2015-07-22 10:30:36.009126|2015-07-22 10:45:35.981527|
|0        |125.16.58.78   |14.999484  |2015-07-22 10:45:45.92667 |2015-07-22 11:00:45.895707|
|0        |117.200.4.141  |14.999393  |2015-07-22 10:47:34.6296  |2015-07-22 11:02:34.593185|
|0        |125.19.34.86   |14.999168  |2015-07-22 10:30:36.849368|2015-07-22 10:45:36.799455|
|1        |111.118.248.24 |14.999123  |2015-07-22 10:34:11.537803|2015-07-22 10:49:11.485166|
|0        |117.215.157.146|14.999106  |2015-07-22 10:31:23.858163|2015-07-22 10:46:23.804526|
|7        |116.50.79.74   |14.998996  |2015-07-22 16:09:51.726939|2015-07-22 16:24:51.66669 |
|2        |203.89.152.131 |14.998981  |2015-07-22 10:32:03.576763|2015-07-22 10:47:03.51563 |
|4        |103.27.171.49  |14.998929  |2015-07-22 10:49:52.259798|2015-07-22 11:04:52.19552 |
|1        |103.29.159.186 |14.998862  |2015-07-22 10:30:29.284428|2015-07-22 10:45:29.21614 |
|1        |117.217.94.18  |14.998674  |2015-07-22 10:49:40.518687|2015-07-22 11:04:40.439132|
+---------+---------------+-----------+--------------------------+--------------------------+
only showing top 20 rows

+--------+-----+
|rangebin|count|
+--------+-----+
|0       |22192|
|1       |66045|
|2       |15239|
|3       |3387 |
|4       |982  |
|5       |1166 |
|6       |1205 |
|7       |1491 |
|8       |1668 |
+--------+-----+